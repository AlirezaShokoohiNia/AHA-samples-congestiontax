root = true

###########################################
# Global defaults
###########################################
[*]
indent_style = space
indent_size = 4
charset = utf-8
end_of_line = crlf
insert_final_newline = true
trim_trailing_whitespace = true

###########################################
# File-specific indentation
###########################################

[*.{json,yml,yaml,xml}]
indent_size = 2

[.editorconfig]
indent_size = 2

[*.md]
trim_trailing_whitespace = false


###########################################
# C# Shared formatting rules
###########################################
[*.cs]
dotnet_remove_unnecessary_usings = true : suggestion
dotnet_style_namespace_match_folder = false
dotnet_style_namespace_usings = inside:error  ## prefer usings inside namespaces
csharp_using_directive_placement = inside_namespace:warning 
csharp_style_expression_bodied_methods = when_on_single_line
dotnet_diagnostic.IDE0007.severity = none # Allow explicit type instead of var
dotnet_diagnostic.IDE0008.severity = none # Allow explicit type instead of var 
csharp_prefer_braces = false
indent_size = 4

########## Basic indentation ##########
csharp_indent_block_contents = true
csharp_indent_braces = false
csharp_indent_case_contents = true
csharp_indent_switch_labels = true

########## Using Directives ##########
# Sort System.* first
# dotnet_sort_system_directives_first = true
# Remove unused usings automatically
dotnet_remove_unnecessary_usings = true : suggestion

########## Expression Preferences ##########
dotnet_style_namespace_usings = inside_namespace:error  ## prefer usings inside namespaces
dotnet_style_prefer_simplified_boolean_expressions = true : suggestion
dotnet_style_prefer_simplified_interpolation = true : suggestion
dotnet_style_null_propagation = true : suggestion
dotnet_style_coalesce_expression = true : suggestion

########## Nullability & analyzers ##########
dotnet_enable_roslyn_analyzers = true
dotnet_analyzer_diagnostic.severity = suggestion


###########################################
# Naming conventions (shared everywhere)
###########################################
# Private fields use _camelCase

dotnet_naming_rule.private_fields_should_be_camel_case.severity = suggestion
dotnet_naming_rule.private_fields_should_be_camel_case.symbols = private_fields
dotnet_naming_rule.private_fields_should_be_camel_case.style = camel_case_underscore

dotnet_naming_symbols.private_fields.applicable_kinds = field
dotnet_naming_symbols.private_fields.applicable_accessibilities = private

dotnet_naming_style.camel_case_underscore.capitalization = camel_case
dotnet_naming_style.camel_case_underscore.required_prefix = _


#######################################################################
# PROJECT-SPECIFIC RULES BASED ON YOUR FOLDER STRUCTURE
#######################################################################

#############################################################################
# 1️⃣ Minimal API Project — AHA.*.Api
#############################################################################
[src/*.Api/**/.cs]

# Prefer var for concise minimal API handlers
csharp_style_var_for_built_in_types = true : suggestion
csharp_style_var_when_type_is_apparent = true : suggestion
csharp_style_var_elsewhere = true : silent

# Prefer concise expression-bodied endpoints
csharp_style_expression_bodied_methods = true : suggestion
csharp_style_expression_bodied_properties = true : suggestion
csharp_style_expression_bodied_local_functions = when_on_single_line : suggestion


#############################################################################
# 2️⃣ Class Libraries — Application, Domain, Infrastructure, Contracts, Seedwork
#############################################################################
# Matched exactly to your real folder names
[src/*.Application/**/.cs]
[src/*.Domain/**/.cs]
[src/*.Infrastructure/**/.cs]
[src/*.Contracts/**/.cs]
[src/*.Seedwork/**/.cs]

# Prefer explicit types for API clarity
csharp_style_var_for_built_in_types = true : suggestion
csharp_style_var_when_type_is_apparent = true : suggestion
csharp_style_var_elsewhere = true : suggestion

# More conservative expression-bodied usage
csharp_style_expression_bodied_methods = false : suggestion
csharp_style_expression_bodied_properties = when_on_single_line : suggestion
csharp_style_expression_bodied_local_functions = false : suggestion


#############################################################################
# 3️⃣ Test Projects — Under /src/Tests/
#############################################################################
# Matches your real test project folders
[src/*.Tests/**/*.cs]
[src/*.Tests/*.cs]
dotnet_diagnostic.CA1707.severity = none  # Allow underscores in test names
dotnet_diagnostic.IDE0058.severity = none # Allow unused expressions in tests

# Tests should be flexible & readable → var preferred
csharp_style_var_for_built_in_types = true : suggestion
csharp_style_var_when_type_is_apparent = true : suggestion
csharp_style_var_elsewhere = true : suggestion

# Do not use expression-bodied test methods for clarity
csharp_style_expression_bodied_methods = false : suggestion

# But allow local helpers to be expression-bodied
csharp_style_expression_bodied_local_functions = when_on_single_line : suggestion


[bin/**]
generated_code = true

[obj/**]
generated_code = true
